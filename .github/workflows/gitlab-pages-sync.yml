name: Sync Jekyll to GitLab Pages

on:
  push:
    branches: [main]

jobs:
  sync-to-gitlab: # æ›´æ”¹ä»»å‹™åç¨±ï¼Œåæ‡‰æˆ‘å€‘åªåšåŒæ­¥
    runs-on: ubuntu-latest
    steps:
      - name: â¬‡ï¸ Checkout GitHub repo
        uses: actions/checkout@v4 # æ¨è–¦æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬

      # ----------------------------------------------------
      # åˆªé™¤ Jekyll å»ºç½®å’Œ Ruby å®‰è£æ­¥é©Ÿ
      # å› ç‚º Jekyll å»ºç½®å°‡åœ¨ GitLab CI/CD ä¸­å®Œæˆ
      # ----------------------------------------------------

      - name: ğŸ”„ Deploy to GitLab
        env:
          GITLAB_TOKEN: ${{ secrets.GITLAB_TOKEN }}
          # ğŸš¨ é—œéµä¿®æ”¹ï¼šå¾ oauth2 è®Šç‚º gitlab-ci-token 
          GITLAB_REPO: https://gitlab-ci-token:${{ secrets.GITLAB_TOKEN }}@gitlab.com/xxyzyh/my-blog.git 
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
          git remote add gitlab $GITLAB_REPO
          echo "ğŸš€ Pushing code to GitLab repository..."
          git push --force --quiet gitlab main:main
          echo "âœ… Synchronization complete!"
